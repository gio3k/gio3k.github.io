<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="./favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="./_app/immutable/assets/0.D1UNqJZk.css" rel="stylesheet">
		<link href="./_app/immutable/assets/LinkButton.CmZSzDOo.css" rel="stylesheet">
		<link href="./_app/immutable/assets/2.BSnlYoS7.css" rel="stylesheet">
		<link href="./_app/immutable/assets/RoundButton.CoaLtbLj.css" rel="stylesheet">
		<link rel="modulepreload" href="./_app/immutable/entry/start.lqI9OIgG.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/BZY-vZP0.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/Cpt4s2BC.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/CAs0FKld.js">
		<link rel="modulepreload" href="./_app/immutable/entry/app.BS7Yskrj.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/CE2Zg5BO.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/BgOI4lrS.js">
		<link rel="modulepreload" href="./_app/immutable/nodes/0.CZUL0UX7.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/WpaIqoA6.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/WjRwV764.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/YX_ne52C.js">
		<link rel="modulepreload" href="./_app/immutable/nodes/2.DPycFJju.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/DvyQVoNH.js">
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!----><div class="flex flex-col items-center py-6 px-10 transition-all"><div class="layout-main-content mt-6 px-2 whitespace-normal flex-1 min-w-[300px] max-w-5xl w-full"><div class="grow mb-6"><div class="mb-5"><div class="text-4xl font-semibold">Gianni <a class="text-xl font-medium" href="/">@ gio.blue</a></div> <span class="opacity-80 text-sm dark:text-gray-300">a.k.a. Gio — software dev living in Western Australia</span></div> <div class="flex flex-row flex-wrap gap-x-10 gap-y-5"><!--[!--><!--]--> <div class="service service-mail flex flex-row svelte-1dk8pul"><div class="clickable button-outer p-2 rounded-2xl mr-3 svelte-1dk8pul" role="button" tabindex="0"><div class="button-icon size-8 svelte-1dk8pul"></div></div> <div class="flex flex-col mt-0.5"><div class="flex flex-row items-center"><span class="title-service font-semibold select-none">Email</span> <span class="title-user ml-1.5 mb-[0.0rem] font-mono svelte-1dk8pul">me@gio.blue</span></div> <span class="text-sm content"><!---->Send me an email<!----></span></div></div><!----> <div class="service service-github flex flex-row svelte-1dk8pul"><div class="clickable button-outer p-2 rounded-2xl mr-3 svelte-1dk8pul" role="button" tabindex="0"><div class="button-icon size-8 svelte-1dk8pul"></div></div> <div class="flex flex-col mt-0.5"><div class="flex flex-row items-center"><span class="title-service font-semibold select-none">GitHub</span> <span class="title-user ml-1.5 mb-[0.0rem] font-mono svelte-1dk8pul">@gio3k</span></div> <span class="text-sm content"><!---->See my personal projects<!----></span></div></div><!----> <div class="service service-small-fish flex flex-row svelte-1dk8pul"><div class="clickable button-outer p-2 rounded-2xl mr-3 svelte-1dk8pul" role="button" tabindex="0"><div class="button-icon size-8 svelte-1dk8pul"></div></div> <div class="flex flex-col mt-0.5"><div class="flex flex-row items-center"><span class="title-service font-semibold select-none">Small Fish</span> <span class="title-user ml-1.5 mb-[0.0rem] font-mono svelte-1dk8pul"></span></div> <span class="text-sm content"><!---->See our game development team<!----></span></div></div><!----></div></div> <!----><head><title>gio.blue</title></head> <div class="flex flex-col"><div class="flex flex-col py-5 rounded-xl"><div class="flex flex-col gap-8"><!--[--><div class="entry entry-type-post svelte-paxut7"><div class="relative entry-header-container flex flex-row justify-between gap-5"><div><div class="item-type-heading flex items-center gap-2 flex-row"><div class="font-semibold uppercase text-gray-600 dark:text-gray-400/90">post</div> <div class="entry-type-heading-bead svelte-paxut7"></div></div> <div class="entry-title text-3xl font-semibold"><div>macOS Keyboard Emulation with C#</div></div> <div class="mt-0.5"><div class="font-semibold text-gray-500 text-sm mb-0.5"><span class="uppercase">December 11, 2023</span> <!--[!--><!--]--></div><!----></div></div> <div class="button svelte-1cmpttb" role="button" tabindex="0"><div style="background-image: url(/images/arrow-right-solid.svg);" class="icon svelte-1cmpttb"></div></div><!----></div> <div class="content overflow-scroll svelte-paxut7"><div class="left">By using the CoreGraphics API in macOS, a developer can emulate a key press without any physical interaction. Doing that is fairly simple in Objective-C or C++, but how can we do the same in C#? <a href="/blog/2023-12-11-macos-keyboard-emulation-with-c">[read more]</a></div></div></div><div class="entry entry-type-post svelte-paxut7"><div class="relative entry-header-container flex flex-row justify-between gap-5"><div><div class="item-type-heading flex items-center gap-2 flex-row"><div class="font-semibold uppercase text-gray-600 dark:text-gray-400/90">post</div> <div class="entry-type-heading-bead svelte-paxut7"></div></div> <div class="entry-title text-3xl font-semibold"><div>Starting the IDEA plugin journey</div></div> <div class="mt-0.5"><div class="font-semibold text-gray-500 text-sm mb-0.5"><span class="uppercase">September 29, 2023</span> <!--[--><span class="uppercase text-gray-400 dark:text-gray-600">— greenery, IDEA, gdscript</span><!--]--></div><!----></div></div> <div class="button svelte-1cmpttb" role="button" tabindex="0"><div style="background-image: url(/images/arrow-right-solid.svg);" class="icon svelte-1cmpttb"></div></div><!----></div> <div class="content overflow-scroll svelte-paxut7"><div class="left">I’ve been using JetBrains Rider for a year now, and I love it. It has great code styling, fast code completion, and context actions that taught me more (by far) about C# than anything else I’ve ever used. <a href="/blog/2023-09-29-the-idea-plugin-journey-lexing-p-1">[read more]</a></div></div></div><!--]--></div><!----></div><!----></div><!----><!----></div></div><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1rdeuv = {
						base: new URL(".", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("./_app/immutable/entry/start.lqI9OIgG.js"),
						import("./_app/immutable/entry/app.BS7Yskrj.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2],
							data: [null,{"type":"data","data":{blogEntries:[{slug:"2023-12-11-macos-keyboard-emulation-with-c",content:"\u003C!--[-->\u003Cp>By using the CoreGraphics API in macOS, a developer can emulate a key press without any physical interaction. Doing that\nis fairly simple in Objective-C\nor C++, but how can we do the same in C#?\u003C/p> \u003Ch2>CoreGraphics\u003C/h2> \u003Cp>\u003Ca href=\"https://developer.apple.com/documentation/coregraphics\" rel=\"nofollow\">CoreGraphics\u003C/a> is a system framework standard in macOS. It\nprovides access to “Quartz Event Services”, which we can use to emulate a key press.\u003C/p> \u003Cp>Let’s take a quick look at how that works in C++:\u003C/p> \u003Cpre>\u003Ccode>\u003Cspan data-line-number=\"1\">\u003Cspan style=\"color: #24292EFF\">CGEventRef e \u003C/span>\u003Cspan style=\"color: #D32F2F\">=\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #6F42C1\">CGEventCreateKeyboardEvent\u003C/span>\u003Cspan style=\"color: #24292EFF\">(\u003C/span>\u003Cspan style=\"color: #1976D2\">NULL\u003C/span>\u003Cspan style=\"color: #212121\">,\u003C/span>\u003Cspan style=\"color: #24292EFF\"> (CGKeyCode) \u003C/span>\u003Cspan style=\"color: #1976D2\">33\u003C/span>\u003Cspan style=\"color: #212121\">,\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #1976D2\">true\u003C/span>\u003Cspan style=\"color: #24292EFF\">);\u003C/span>\u003C/span>\u003Cspan data-line-number=\"2\">\u003Cspan style=\"color: #6F42C1\">CGEventPost\u003C/span>\u003Cspan style=\"color: #24292EFF\">(kCGHIDEventTap\u003C/span>\u003Cspan style=\"color: #212121\">,\u003C/span>\u003Cspan style=\"color: #24292EFF\"> e);\u003C/span>\u003C/span>\u003Cspan data-line-number=\"3\">\u003Cspan style=\"color: #6F42C1\">CFRelease\u003C/span>\u003Cspan style=\"color: #24292EFF\">(e);\u003C/span>\u003C/span>\u003C/code>\u003C/pre> \u003Cp>It’s fairly simple - create, post and release the event. This code snippet should type a little \u003Ccode>[\u003C/code> into whatever window\nyou’re focused on.\u003C/p> \u003Cp>Before we start putting this into C#, let’s examine the two important functions here.\u003C/p> \u003Ch3>\u003Ca href=\"https://developer.apple.com/documentation/coregraphics/1456564-cgeventcreatekeyboardevent\" rel=\"nofollow\">CGEventCreateKeyboardEvent\u003C/a>\u003C/h3> \u003Cp>This takes a source reference, virtual key code and boolean (will the key be pressed or unpressed?) and returns a\nreference to the event.\u003C/p> \u003Cp>Event sources are out of scope for this post, but feel free to check\nout\nthe \u003Ca href=\"https://developer.apple.com/documentation/coregraphics/1408776-cgeventsourcecreate\" rel=\"nofollow\">documentation for CGEventSourceCreate\u003C/a>.\u003C/p> \u003Ch3>\u003Ca href=\"https://developer.apple.com/documentation/coregraphics/1456527-cgeventpost\" rel=\"nofollow\">CGEventPost\u003C/a>\u003C/h3> \u003Cp>This takes a \u003Ccode>CGEventTapLocation\u003C/code> for the first argument, with the event reference we want to post as the second\nargument.\u003C/p> \u003Cp>\u003Cem>I’m not too sure about this, but I think\u003C/em> the event tap location is where the event will be placed / processed.\u003C/p> \u003Cp>We’ll just use \u003Ccode>kCGHIDEventTap\u003C/code> for now, which will place the event tap “where HID system events enter the window\nserver”\u003Ca href=\"https://developer.apple.com/documentation/coregraphics/cgeventtaplocation\" rel=\"nofollow\">^eventtap0\u003C/a>\u003C/p> \u003Ch2>Unmanaged Interop\u003C/h2> \u003Cp>Let’s get this into C#!\u003C/p> \u003Cp>We’ve already established the functions we need:\u003C/p> \u003Col>\u003Cli>CGEventCreateKeyboardEvent\u003C/li> \u003Cli>CGEventPost\u003C/li> \u003Cli>CFRelease\u003C/li>\u003C/ol> \u003Cp>CoreFoundation and CoreGraphics can both be found in \u003Ccode>/System/Library/Frameworks\u003C/code>. More specifically, we can find the\ndynamic libraries at \u003Ccode>/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation\u003C/code> and \u003Ccode>/System/Library/Frameworks/CoreGraphics.framework/CoreGraphics\u003C/code>.\u003C/p> \u003Cp>Let’s use DllImport to expose these functions.\u003C/p> \u003Cpre>\u003Ccode>\u003Cspan data-line-number=\"1\">\u003Cspan style=\"color: #D32F2F\">public\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">enum\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #6F42C1\">CGKeyCode\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #212121\">:\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">ushort\u003C/span>\u003Cspan style=\"color: #24292EFF\"> {\u003C/span>\u003C/span>\u003Cspan data-line-number=\"2\">\u003Cspan style=\"color: #24292EFF\">    \u003C/span>\u003Cspan style=\"color: #C2C3C5\">// ...\u003C/span>\u003C/span>\u003Cspan data-line-number=\"3\">\u003Cspan style=\"color: #24292EFF\">}\u003C/span>\u003C/span>\u003Cspan data-line-number=\"4\">\u003C/span>\u003Cspan data-line-number=\"5\">\u003Cspan style=\"color: #C2C3C5\">// Note that these snippets use unsafe code - if you can't use that, use IntPtr instead of void*, etc.\u003C/span>\u003C/span>\u003Cspan data-line-number=\"6\">\u003C/span>\u003Cspan data-line-number=\"7\">\u003Cspan style=\"color: #24292EFF\">[\u003C/span>\u003Cspan style=\"color: #6F42C1\">DllImport\u003C/span>\u003Cspan style=\"color: #24292EFF\">(\u003C/span>\u003Cspan style=\"color: #22863A\">\"/System/Library/Frameworks/CoreGraphics.framework/CoreGraphics\"\u003C/span>\u003Cspan style=\"color: #24292EFF\">)]\u003C/span>\u003C/span>\u003Cspan data-line-number=\"8\">\u003Cspan style=\"color: #D32F2F\">public\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">static\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">extern\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">unsafe\u003C/span>\u003Cspan style=\"color: #24292EFF\"> void\u003C/span>\u003Cspan style=\"color: #D32F2F\">*\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #6F42C1\">CGEventCreateKeyboardEvent\u003C/span>\u003Cspan style=\"color: #24292EFF\">(void\u003C/span>\u003Cspan style=\"color: #D32F2F\">*\u003C/span>\u003Cspan style=\"color: #24292EFF\"> source\u003C/span>\u003Cspan style=\"color: #212121\">,\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #6F42C1\">CGKeyCode\u003C/span>\u003Cspan style=\"color: #24292EFF\"> key\u003C/span>\u003Cspan style=\"color: #212121\">,\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">bool\u003C/span>\u003Cspan style=\"color: #24292EFF\"> keyDown);\u003C/span>\u003C/span>\u003C/code>\u003C/pre> \u003Cpre>\u003Ccode>\u003Cspan data-line-number=\"1\">\u003Cspan style=\"color: #D32F2F\">public\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">enum\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #6F42C1\">CGEventTapLocation\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #212121\">:\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">ushort\u003C/span>\u003Cspan style=\"color: #24292EFF\"> {\u003C/span>\u003C/span>\u003Cspan data-line-number=\"2\">\u003Cspan style=\"color: #24292EFF\">    cghidEventTap \u003C/span>\u003Cspan style=\"color: #D32F2F\">=\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #1976D2\">0\u003C/span>\u003Cspan style=\"color: #212121\">,\u003C/span>\u003C/span>\u003Cspan data-line-number=\"3\">\u003Cspan style=\"color: #24292EFF\">    cgSessionEventTap \u003C/span>\u003Cspan style=\"color: #D32F2F\">=\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #1976D2\">1\u003C/span>\u003Cspan style=\"color: #212121\">,\u003C/span>\u003C/span>\u003Cspan data-line-number=\"4\">\u003Cspan style=\"color: #24292EFF\">    cgAnnotatedSessionEventTap \u003C/span>\u003Cspan style=\"color: #D32F2F\">=\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #1976D2\">2\u003C/span>\u003C/span>\u003Cspan data-line-number=\"5\">\u003Cspan style=\"color: #24292EFF\">}\u003C/span>\u003C/span>\u003Cspan data-line-number=\"6\">\u003C/span>\u003Cspan data-line-number=\"7\">\u003Cspan style=\"color: #24292EFF\">[\u003C/span>\u003Cspan style=\"color: #6F42C1\">DllImport\u003C/span>\u003Cspan style=\"color: #24292EFF\">(\u003C/span>\u003Cspan style=\"color: #22863A\">\"/System/Library/Frameworks/CoreGraphics.framework/CoreGraphics\"\u003C/span>\u003Cspan style=\"color: #24292EFF\">)]\u003C/span>\u003C/span>\u003Cspan data-line-number=\"8\">\u003Cspan style=\"color: #D32F2F\">public\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">static\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">extern\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">unsafe\u003C/span>\u003Cspan style=\"color: #24292EFF\"> void\u003C/span>\u003Cspan style=\"color: #D32F2F\">*\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #6F42C1\">CGEventPost\u003C/span>\u003Cspan style=\"color: #24292EFF\">(\u003C/span>\u003Cspan style=\"color: #6F42C1\">CGEventTapLocation\u003C/span>\u003Cspan style=\"color: #24292EFF\"> tap\u003C/span>\u003Cspan style=\"color: #212121\">,\u003C/span>\u003Cspan style=\"color: #24292EFF\"> void\u003C/span>\u003Cspan style=\"color: #D32F2F\">*\u003C/span>\u003Cspan style=\"color: #24292EFF\"> eventRef);\u003C/span>\u003C/span>\u003C/code>\u003C/pre> \u003Cpre>\u003Ccode>\u003Cspan data-line-number=\"1\">\u003Cspan style=\"color: #24292EFF\">[\u003C/span>\u003Cspan style=\"color: #6F42C1\">DllImport\u003C/span>\u003Cspan style=\"color: #24292EFF\">(\u003C/span>\u003Cspan style=\"color: #22863A\">\"/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation\"\u003C/span>\u003Cspan style=\"color: #24292EFF\">)]\u003C/span>\u003C/span>\u003Cspan data-line-number=\"2\">\u003Cspan style=\"color: #D32F2F\">public\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">static\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">extern\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">unsafe\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #D32F2F\">void\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #6F42C1\">CFRelease\u003C/span>\u003Cspan style=\"color: #24292EFF\">(void* typeRef);\u003C/span>\u003C/span>\u003C/code>\u003C/pre> \u003Ch2>Basic Usage\u003C/h2> \u003Cp>As a small example, let’s rewrite the C++ sample from the beginning:\u003C/p> \u003Cpre>\u003Ccode>\u003Cspan data-line-number=\"1\">\u003Cspan style=\"color: #D32F2F\">var\u003C/span>\u003Cspan style=\"color: #24292EFF\"> e \u003C/span>\u003Cspan style=\"color: #D32F2F\">=\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #6F42C1\">CGEventCreateKeyboardEvent\u003C/span>\u003Cspan style=\"color: #24292EFF\">((void\u003C/span>\u003Cspan style=\"color: #D32F2F\">*\u003C/span>\u003Cspan style=\"color: #24292EFF\">)\u003C/span>\u003Cspan style=\"color: #1976D2\">0x0\u003C/span>\u003Cspan style=\"color: #212121\">,\u003C/span>\u003Cspan style=\"color: #24292EFF\"> (\u003C/span>\u003Cspan style=\"color: #6F42C1\">CGKeyCode\u003C/span>\u003Cspan style=\"color: #24292EFF\">)\u003C/span>\u003Cspan style=\"color: #1976D2\">33\u003C/span>\u003Cspan style=\"color: #212121\">,\u003C/span>\u003Cspan style=\"color: #24292EFF\"> \u003C/span>\u003Cspan style=\"color: #1976D2\">true\u003C/span>\u003Cspan style=\"color: #24292EFF\">);\u003C/span>\u003C/span>\u003Cspan data-line-number=\"2\">\u003Cspan style=\"color: #6F42C1\">CGEventPost\u003C/span>\u003Cspan style=\"color: #24292EFF\">(\u003C/span>\u003Cspan style=\"color: #1976D2\">CGEventTapLocation\u003C/span>\u003Cspan style=\"color: #24292EFF\">.\u003C/span>\u003Cspan style=\"color: #1976D2\">cghidEventTap\u003C/span>\u003Cspan style=\"color: #212121\">,\u003C/span>\u003Cspan style=\"color: #24292EFF\"> e);\u003C/span>\u003C/span>\u003Cspan data-line-number=\"3\">\u003Cspan style=\"color: #6F42C1\">CFRelease\u003C/span>\u003Cspan style=\"color: #24292EFF\">(e);\u003C/span>\u003C/span>\u003C/code>\u003C/pre> \u003Ch2>Footnotes\u003C/h2>\u003C!--]-->",contentPreview:"By using the CoreGraphics API in macOS, a developer can emulate a key press without any physical interaction. Doing that is fairly simple in Objective-C or C++, but how can we do the same in C#?",coverImageUrl:"",layout:"post",title:"macOS Keyboard Emulation with C#",created_at:"2023-12-11 21:54 +0800",type:"post",createdAt:new Date(1702302840000),updatedAt:new Date(1740589108103)},{slug:"2023-09-29-the-idea-plugin-journey-lexing-p-1",content:"\u003C!--[-->\u003Cp>I’ve been using JetBrains Rider for a year now, and I love it.\nIt has great code styling, fast code completion, and context actions that taught me more (by far) about C# than\nanything else I’ve ever used.\u003C/p> \u003Cp>I’ve only started having a problem with Rider after trying Godot[^godot] — an open-source game engine that uses the\nGDScript\nscripting\nlanguage.\u003C/p> \u003Ch3>About GDScript\u003C/h3> \u003Cblockquote>\u003Cp>GDScript is a high-level, object-oriented, imperative, and gradually typed programming language built for Godot. It\nuses an indentation-based syntax similar to languages like Python.\u003C/p> \u003Cp>— \u003Ca href=\"https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_basics.html\" rel=\"nofollow\">GDScript Reference\u003C/a>\u003C/p>\u003C/blockquote> \u003Cp>While it looks similar to Python, GDScript is mainly purpose-made for use around Godot’s scene tree, making\ndevelopment with it actually pretty different in practice.\u003C/p> \u003Cp>GDScript definitely isn’t the only supported language, and even with\na \u003Ca href=\"https://github.com/Vivraan/godot-lang-support\" rel=\"nofollow\">huge list\u003C/a> of community-supported languages, there’s still another\nofficially supported language I haven’t mentioned…\u003C/p> \u003Ch3>A Quick Note About C#\u003C/h3> \u003Cp>Godot actually \u003Cem>does\u003C/em> support C#! Even more than that, it’s actually a great\nalternative to GDScript — it’s way faster (~4x), and it has more features (like interfaces!), with great IDE support and\nthe\nfull\nlibrary of NuGet packages.\u003C/p> \u003Cp>So… why not just use C#? Well, it’s simple — I just don’t like using it for Godot. Being desktop-only and having\nannoying build times when pressing play are a few reasons I don’t really want to use it.\u003C/p> \u003Cp>It’s not for me right now, but I’m still excited to see where it ends up.\u003C/p> \u003Ch3>The Problem\u003C/h3> \u003Cp>Let’s cut to the chase. Rider, along with all other IDEA-based IDEs[^idea], doesn’t have official support for GDScript.\nWhile\nthere \u003Cem>are\u003C/em> a few community-created plugins, I haven’t found one (yet) that gives me a similar experience to the C#\nsupport in Rider.\u003C/p> \u003Cp>So what’s the solution? Simple — write a plugin for Rider (and the other JetBrains IDEs) with awesome GDScript support.\u003C/p> \u003Ch2>The Plugin\u003C/h2> \u003Cp>Creating the plugin is actually pretty simple. Open up IntelliJ IDEA, make a new project, and select \u003Cem>IDE Plugin\u003C/em>. At\nthis point, it seems like making the plugin might not be too hard! (More on this later)\u003C/p> \u003Ch3>The Parser and You\u003C/h3> \u003Cp>Many IDEA extensions / plugins are \u003Ca href=\"https://github.com/JetBrains/intellij-community\" rel=\"nofollow\">open-source\u003C/a>. These are, of course,\ngreat resources to use when creating a plugin, but now the first roadblock is visible — the API.\u003C/p> \u003Cblockquote>\u003Cp>The Program Structure Interface, commonly referred to as just PSI, is the layer in the IntelliJ Platform responsible\nfor parsing files and creating the syntactic and semantic code model that powers so many of the platform’s features.\u003C/p> \u003Cp>— \u003Ca href=\"https://plugins.jetbrains.com/docs/intellij/psi.html\" rel=\"nofollow\">Part IV - PSI\u003C/a>\u003C/p>\u003C/blockquote> \u003Cp>So… how do I use that?\u003C/p> \u003Cp>If you looked at the open-source plugins, you might’ve noticed a pattern — there are a few files ending in \u003Ccode>.bnf\u003C/code>[^bnf]\nand \u003Ccode>.flex\u003C/code> which, at some point in the process, get converted into Java code.\u003C/p> \u003Cblockquote>\u003Cp>While coding [a] parser manually is quite possible, we highly recommend generating parser and corresponding PSI\nclasses\nfrom grammars using [the] Grammar-Kit plugin.\u003C/p> \u003Cp>— \u003Ca href=\"https://plugins.jetbrains.com/docs/intellij/implementing-parser-and-psi.html#parser-implementation\" rel=\"nofollow\">Parser Implementation\u003C/a>\u003C/p>\u003C/blockquote> \u003Cp>\u003Ccode>.bnf\u003C/code> and \u003Ccode>.flex\u003C/code> files can be used to generate a lexer[^lexer] (using JFlex), which gets\nconverted into\nJava code (\u003Ccode>class ?? implements FlexLexer\u003C/code>) that can be used pretty painlessly with PSI.\u003C/p> \u003Cp>This does make sense — it’s not as much code as writing a full lexer, and the generator \u003Cem>does\u003C/em> seem pretty helpful,\nespecially\nif you had to make hundreds of language plugins. Small problem though…\u003C/p> \u003Ch3>My Own Tokenizer\u003C/h3> \u003Cp>I really don’t want to use a generated lexer. I have a few reasons. (whether you think they’re good or not is up to\nyou)\u003C/p> \u003Col>\u003Cli>I already have a GDScript lexer that I made and tested in Kotlin\u003C/li> \u003Cli>I don’t find it as fun to write generated parsers\u003C/li> \u003Cli>I’m not great at BNF and similar formats — I don’t want to maintain something I’m clueless about\u003C/li>\u003C/ol> \u003Cp>Now there’s a problem — how do I get my lexer to work alongside PSI? There’s really not much documentation about using a\ncustom lexer…\u003C/p> \u003Ch2>Thoughts\u003C/h2> \u003Cp>Your language plugin needs a class deriving from \u003Cem>ParserDefinition\u003C/em>. It’s the starting point for (as you would think)\nmost of the plugin’s parsing.\u003C/p> \u003Cp>Let’s take a look at one of ParserDefinition’s abstract functions. We’ll look at more of them later (and also find out\nwhere PSI comes in)\u003C/p> \u003Cp>\u003Cstrong>createLexer\u003C/strong>, returns \u003Cem>Lexer\u003C/em>, takes \u003Cem>Project?\u003C/em> \\\nThis is where you should instantiate your lexer and return it. Let’s talk about that — how do you make the lexer?\u003C/p> \u003Ch3>LexerBase\u003C/h3> \u003Cp>Your lexer needs to derive from \u003Cem>LexerBase\u003C/em>. It’s a tokenizer.\u003C/p> \u003Cp>The name LexerBase is a bit misleading. You don’t really want to do much work or analysis here — you just need to output\ntoken types and positions. Don’t parse anything, don’t read any values! Implement things like that in the next stages,\nwhere you\ncan have proper error management.\u003C/p> \u003Cp>The \u003Cem>start()\u003C/em> function will be called, providing your lexer with a buffer to read and a boundary (\u003Cem>startOffset\u003C/em>, \u003Cem>endOffset\u003C/em>) to stay inside.\u003C/p> \u003Cp>\u003Ccode>*edit:* getTokenType()\u003C/code> needs to return null eventually, or bad things will happen and the heap will fill up! When you’re\nout of tokens, return null!\u003C/p> \u003Ch2>What’s Next\u003C/h2> \u003Cp>The next step is to parse the tokens into a syntax tree — this seems to be a mixture of PsiBuilder (which holds the AST\nwhile it’s built)\nand PsiParser, which parses the tokens, using PsiBuilder as storage.\u003C/p> \u003Cp>More on that soon (when I get to it!)\u003C/p> \u003Ch2>Footnotes\u003C/h2> \u003Cp>[^godot]: \u003Ca href=\"https://godotengine.org/\" rel=\"nofollow\">https://godotengine.org/\u003C/a> [^idea]: IDEA-based refers to a JetBrains IDE originally based on IntelliJ IDEA.\n[^bnf]: \u003Ca href=\"https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_form\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Backus–Naur_form\u003C/a> [^lexer]: \u003Ca href=\"https://en.wikipedia.org/wiki/Lexical_analysis\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Lexical_analysis\u003C/a>\u003C/p>\u003C!--]-->",contentPreview:"I’ve been using JetBrains Rider for a year now, and I love it. It has great code styling, fast code completion, and context actions that taught me more (by far) about C# than anything else I’ve ever used.",coverImageUrl:"",layout:"post",title:"Starting the IDEA plugin journey",tags:["greenery","IDEA","gdscript"],created_at:"2023-09-29 01:00 +0800",type:"post",createdAt:new Date(1695920400000),updatedAt:new Date(1740589108102)}]},"uses":{}}],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
